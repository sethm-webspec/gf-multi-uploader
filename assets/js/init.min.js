let GFMU_loaders={};function downloadFromAjaxPost_XHR(e,t,i){let o=new XMLHttpRequest;o.open("POST",e,!0),o.responseType="arraybuffer",o.onload=function(){if(200===this.status){let e="",t=o.getResponseHeader("Content-Disposition");if(t&&-1!==t.indexOf("attachment")){let i=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(t);null!=i&&i[1]&&(e=i[1].replace(/['"]/g,""))}let i=new Blob([this.response],{type:o.getResponseHeader("Content-Type")});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,e);else{let t=window.URL||window.webkitURL,o=t.createObjectURL(i);if(e){let t=document.createElement("a");void 0===t.download?window.location=o:(t.href=o,t.download=e,document.body.appendChild(t),t.click())}else window.location=o;setTimeout(function(){t.revokeObjectURL(o)},100)}}},o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),jQuery.each(i,function(e,t){o.setRequestHeader(e,t)}),o.send(jQuery.param(t))}jQuery(document).ready(function(e){function t(e,t,i){return'<input type="hidden" name="'+t+'_tname" value="'+i+'"/>'}function i(){e.each(GFMU_options,function(i,o){GFMU_loaders[i]=e("#"+o.element).plupload({runtimes:o.runtimes,url:o.wp_ajax_url,max_file_size:o.max_file_size,chunk_size:o.chunk_size,unique_names:o.rename_file_status,prevent_duplicates:o.duplicates_status,multiple_queues:!0,multipart_params:{action:"gfmu-plupload-submit",currentFormID:o.params.form_id,currentFieldID:o.params.field_id,nonce:o.params.nonce},filters:{max_file_size:o.max_file_size,mime_types:[{title:"files",extensions:o.filters.files}]},resize:{width:1920,height:1080,quality:80,preserve_headers:!1},rename:!1,thumb_width:100,thumb_height:60,thumb_crop:!1,sortable:!0,dragdrop:o.drag_drop_status,views:{list:o.list_view,thumbs:o.thumb_view,active:o.ui_view},flash_swf_url:o.flash_url,silverlight_xap_url:o.silverlight_url,init:{Error:function(e,t){},PostInit:function(n){if(document.getElementById("filelist_"+i).innerHTML="",void 0!==o.setupFiles){let i,a,r=0;e.each(o.setupFiles,function(l,s){void 0!==s.o_name&&(i=s.o_name);let d=parseInt(s.size,10);d<=0&&(d=178542),(a=new plupload.File({name:i})).id=s.id,a.target_name=s.t_name,a.percent=100,a.status=plupload.DONE,a.size=d,a.loaded=d,a.origSize=d,a.completeTimestamp=Date.now(),a.lastModified=s.lastModified,a.type=s.mime_type||"image/jpeg",a.url=s.url,a.wpid=s.wpid,r++,n.addFile(a),e("#gform_"+o.params.form_id).append(t(a.id,a.id,a.target_name))})}e(document).trigger("mthPluploadInit",o.params.field_id)},FileUploaded:function(i,n,a){let r=e.parseJSON(a.response);"error"===r.result?i.trigger("Error",{code:r.error.code,message:r.error.message,file:n}):"success"===r.result?(e("#gform_"+o.params.form_id).append(t(n.id,n.id,r.success.file_id)),e(document).trigger("mthPluploadFileUploaded",i,n,a)):i.trigger("Error",{code:300,message:o.i18n.server_error,file:n})},FilesAdded:function(t,i){let n=!1;plupload.each(i,function(i){n=!1,t.files.length>o.max_files?(e("#"+i.id).toggle("highlight",function(){this.remove()}),t.removeFile(i),t.trigger("Error",{message:o.i18n.file_limit_error}),n=!1):n=!0}),!0===n&&!0===o.auto_upload&&t.start()},FilesRemoved:function(t,i){e(document).trigger("mthPluploadFileRemoved",t,i),i.forEach(function(t){t.wpid&&e.ajax({type:"POST",url:o.wp_ajax_url,data:{action:"gfmu_delete_file",nonce:o.params.nonce,file_id:t.id,tmp_name:t.target_name,file_wpid:t.wpid}}).done(function(i){e("input[name="+t.id+"_tname]").remove()})})},UploadComplete:function(e,t){}}})}),e(".plupload_download_hook").on("click",function(t){t.preventDefault();let i=e(this).data("id").split("_").pop();const o={nonce:GFMU_options[i].params.nonce,action:"gfmu_download_file",post_id:new URLSearchParams(window.location.search).get("gform_post_id")};downloadFromAjaxPost_XHR(GFMU_options[i].wp_ajax_url,o,Array("Content-type","application/zip"))})}"undefined"!=typeof GFMU_options&&(e(document).bind("gform_page_loaded",function(){i()}),i())});